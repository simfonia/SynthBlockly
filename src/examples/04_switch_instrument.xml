<xml xmlns="https://developers.google.com/blockly/xml">
  <variables>
    <variable id="4kFk$B_8VRtg9#,1otIT">note</variable>
    <variable id="9:^.}}q,!02#XYYzHqxe">velocity</variable>
    <variable id="mJCT}0J}/8Z6sm[$fiQ=">channel</variable>
  </variables>
  <block type="sb_instrument_container" id="cont_piano" x="10" y="10">
    <field name="NAME">Piano</field>
    <statement name="STACK">
      <block type="sb_create_synth_instrument" id="create_piano">
        <field name="TYPE">PolySynth</field>
        <next>
          <block type="sb_container_adsr" id="piano_adsr">
            <field name="A">0.01</field>
            <field name="D">0.4</field>
            <field name="S">0.2</field>
            <field name="R">0.5</field>
          </block>
        </next>
      </block>
    </statement>
  </block>
  <block type="sb_instrument_container" id="cont_strings" x="10" y="130">
    <field name="NAME">Strings</field>
    <statement name="STACK">
      <block type="sb_create_synth_instrument" id="create_strings">
        <field name="TYPE">FMSynth</field>
        <next>
          <block type="sb_container_adsr" id="strings_adsr">
            <field name="A">0.5</field>
            <field name="D">1</field>
            <field name="S">1</field>
            <field name="R">0.2</field>
          </block>
        </next>
      </block>
    </statement>
  </block>
  <block type="sb_master_container" id="setup_master" x="10" y="250">
    <statement name="STACK">
      <block type="sb_container_setup_effect" id="master_limiter">
        <mutation effect_type="limiter"></mutation>
        <field name="EFFECT_TYPE">limiter</field>
        <value name="THRESHOLD">
          <shadow type="math_number" id="XKZ0ZVA-4{%lwPrHH2LT">
            <field name="NUM">-1</field>
          </shadow>
        </value>
      </block>
    </statement>
  </block>
  <block type="sb_comment" id="switch_guide" x="10" y="370">
    <field name="COMMENT">此範例展示如何「在演奏中即時切換音色」。&amp;#10;&amp;#10;1. 樂器定義：&amp;#10;- 我們建立了兩個樂器：Piano (PolySynth) 與 Strings (FMSynth)。&amp;#10;2. 即時切換樂器：&amp;#10;- 彈奏 MIDI F3 (53) 時：切換到 Piano。&amp;#10;- 彈奏 MIDI G3 (55) 時：切換到 Strings。&amp;#10;- 彈奏 MIDI F#3 (54) 時：拍手聲。&amp;#10;- 彈奏 MIDI G# (56)或更高音：則會以「目前選定」的樂器發聲。&amp;#10;- 使用PC 鍵盤請用左右方向鍵切換樂器。</field>
    <next>
      <block type="sb_define_chord" id="def_cm7">
        <field name="NAME">CM7</field>
        <field name="NOTES_STRING">C4,E4,G4,B4</field>
        <next>
          <block type="sb_toggle_pc_keyboard_midi" id="on_pc">
            <field name="ACTION">ON</field>
            <next>
              <block type="sb_map_key_to_chord" id="map_a">
                <field name="KEY_CODE">KeyA</field>
                <field name="CHORD_NAME">CM7</field>
                <next>
                  <block type="sb_map_midi_to_chord" id="map_54">
                    <field name="MIDI_NOTE">54</field>
                    <field name="CHORD_NAME">CM7</field>
                  </block>
                </next>
              </block>
            </next>
          </block>
        </next>
      </block>
    </next>
  </block>
  <block type="sb_midi_note_received" id="midi_logic" x="10" y="670">
    <field name="NOTE" id="4kFk$B_8VRtg9#,1otIT">note</field>
    <field name="VELOCITY" id="9:^.}}q,!02#XYYzHqxe">velocity</field>
    <field name="CHANNEL" id="mJCT}0J}/8Z6sm[$fiQ=">channel</field>
    <statement name="DO">
      <block type="controls_if" id="if_53">
        <value name="IF0">
          <block type="logic_compare" id="ip{c=P00.SGYG_H3^lQG">
            <field name="OP">EQ</field>
            <value name="A">
              <block type="variables_get" id="Q;C/6-|%iIM3+3*Z;3Dh">
                <field name="VAR" id="4kFk$B_8VRtg9#,1otIT">note</field>
              </block>
            </value>
            <value name="B">
              <block type="math_number" id="}[7|u[reeWZ.QFg?M8b|">
                <field name="NUM">53</field>
              </block>
            </value>
          </block>
        </value>
        <statement name="DO0">
          <block type="sb_select_current_instrument" id="3hr;Bso6mvP`FnD5E+xW">
            <field name="NAME">Piano</field>
          </block>
        </statement>
        <next>
          <block type="controls_if" id="if_55">
            <value name="IF0">
              <block type="logic_compare" id="!knXX#ju$ws}W-A|x9.n">
                <field name="OP">EQ</field>
                <value name="A">
                  <block type="variables_get" id="H^e~XE699]X@#Qi@.F_|">
                    <field name="VAR" id="4kFk$B_8VRtg9#,1otIT">note</field>
                  </block>
                </value>
                <value name="B">
                  <block type="math_number" id="[8r(IzL!(}S})J)Ve/~n">
                    <field name="NUM">55</field>
                  </block>
                </value>
              </block>
            </value>
            <statement name="DO0">
              <block type="sb_select_current_instrument" id="}EjM=ekh]L*tS(7?0b,t">
                <field name="NAME">Strings</field>
              </block>
            </statement>
            <next>
              <block type="controls_if" id="if_54">
                <value name="IF0">
                  <block type="logic_compare" id="gWZUIRgUu@]UbS]V]:1D">
                    <field name="OP">EQ</field>
                    <value name="A">
                      <block type="variables_get" id="}Ji(:mQzH$G}9arF}$eP">
                        <field name="VAR" id="4kFk$B_8VRtg9#,1otIT">note</field>
                      </block>
                    </value>
                    <value name="B">
                      <block type="math_number" id="WE37X;o[O=~6i.)gv~{s">
                        <field name="NUM">54</field>
                      </block>
                    </value>
                  </block>
                </value>
                <statement name="DO0">
                  <block type="jazzkit_play_drum" id="l?hl~pUfgODsbVN0SrkE">
                    <field name="DRUM_TYPE">D#1</field>
                  </block>
                </statement>
                <next>
                  <block type="controls_if" id="if_gt55">
                    <value name="IF0">
                      <block type="logic_compare" id="!1T/:MYX|0%/jRi44adZ">
                        <field name="OP">GT</field>
                        <value name="A">
                          <block type="variables_get" id="mKB-iQc;!ZD:T?FSK;Os">
                            <field name="VAR" id="4kFk$B_8VRtg9#,1otIT">note</field>
                          </block>
                        </value>
                        <value name="B">
                          <block type="math_number" id="oYYQg}yH:qTkmj}U.8s8">
                            <field name="NUM">55</field>
                          </block>
                        </value>
                      </block>
                    </value>
                    <statement name="DO0">
                      <block type="sb_midi_play" id="c[uiI~droR8nbW]uC(wt">
                        <value name="NOTE">
                          <shadow type="variables_get" id="m{_(eEn^G?S1[C*(u4R7">
                            <field name="VAR" id="4kFk$B_8VRtg9#,1otIT">note</field>
                          </shadow>
                        </value>
                        <value name="VELOCITY">
                          <shadow type="variables_get" id="^4Y=X}gp^NI%/i0HNcx(">
                            <field name="VAR" id="9:^.}}q,!02#XYYzHqxe">velocity</field>
                          </shadow>
                        </value>
                        <value name="CHANNEL">
                          <shadow type="variables_get" id="Tg(YA)!xq[.x=%(xy#b|">
                            <field name="VAR" id="mJCT}0J}/8Z6sm[$fiQ=">channel</field>
                          </shadow>
                        </value>
                      </block>
                    </statement>
                  </block>
                </next>
              </block>
            </next>
          </block>
        </next>
      </block>
    </statement>
  </block>
</xml>