
## 2026-01-28 工作日誌

### 1. 語系系統大規模重構 (Naming consistency)
- **統一規範**：所有語系 Key 重新命名為 `SB_` (積木)、`SB_CAT_` (分類/顏色)、`SB_PARAM_` (參數標籤/選項)、`LOG_` (日誌)。
- **結構化排序**：語系檔內容按 UI -> Categories -> Logs -> Blocks -> Params 順序排列，並確保中英文順序完全對應。
- **全域替換**：已完成所有積木定義檔 (`js/blocks/*.js`) 與 `toolbox.js` 的引用更新。

### 2. 音序器延音功能實作
- **符號定義**：在步進音序器中，`.` 為休止，`-` 為延音。
- **邏輯實現**：修改 `SequencerService.playRhythmSequence`，遇到音符時會自動向後掃描 `-` 符號並計算總時值傳遞給 `triggerAttackRelease`。
- **文檔同步**：已更新 `public/docs/step_sequencer_readme` 中、英文說明文件。

### 3. 系統健壯性優化
- **命名防呆**：在 `sb_instrument_container` 與 `sb_define_chord` 產生器中加入保留字檢查，禁止使用系統關鍵字 (`KICK` 等) 並在 UI 報錯。
- **日誌 Key 顯示修復**：透過延後 `audioEngine` 核心樂器初始化時機，確保 Log 觸發時語系已載入完成。
- **積木約束恢復**：重新實作 `updateContextualBlocks` 監聽器，確保脫離容器的積木正確變灰 (Disabled)，使用 `setDisabledReason` 解決 v12 報錯。

### 4. 測試工具更新
- **Snapshot 路徑修復**：移除 `snapshot.html` 中的 `encodeURIComponent`，支援子資料夾路徑；修正範例 12-15 的目錄對應關係。
- **檔案結構同步**：更新 `FILE_STRUCTURE.md` 以反映真實的範例檔案路徑。

