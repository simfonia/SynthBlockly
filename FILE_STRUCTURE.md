# SynthBlockly 專案檔案結構

本文件說明 SynthBlockly 專案的現代化模組架構。

- `synthblockly/`
  - `index.html`: Vite 專案主入口點，包含語系偵測邏輯。
  - `main.js`: Vite 進入點，載入 Tone.js 與 p5.js。
  - `styles.css`: 全域樣式，包含示波器與 ADSR 視覺化版面。
  - `vite.config.js`: 構建配置。
  - `public/`: 靜態資源（音訊樣本、說明文件、i18n 檔案）。
    - `docs/`: 積木說明文件 (HTML 格式，支援中英雙語)。
      - `examples_readme_*.html`: 範例專案使用說明與開發規範。
      - `performance_readme_*.html`: 演奏音符積木說明。
      - `step_sequencer_readme_*.html`: 步進音序器使用指南。
      - `transport_readme_*.html`: 小節偏移排程指南。
      - `melody_readme_*.html`: 旋律清單編寫指南 (已新增和弦名稱支援說明)。
    - `locales/`: Blockly 核心語言包 (JSON)。
    - `samples/`: 音訊樣本庫（包含爵士鼓、小提琴與特殊音效 SFX）。
  - `src/`: 原始碼與資料。
    - `examples/`: **(V2.1) 範例專案庫**。
      - `*.xml`: 純軟體範例 (01-09, 15)。
      - `10-1_Functions...xml`: 函式模組化編曲。
      - `10-2_Sequencer...xml`: 音序器編曲技巧。
      - `11_Serial_KICK/`: Arduino 觸發大鼓範例。
      - `12_wah-wah/`: Arduino 光敏電阻動態效果範例。
      - `13_Chord_Pad/`: TTP229 和弦觸發板範例。
      - `14_Drum_Pad/`: TTP229 觸控打擊墊範例。
  - `js/`: 核心 JavaScript 代碼。
    - `app.js`: 應用程式啟動中心，負責初始化所有模組。
    - `core/`: 核心引擎與管理。
      - `audioEngine.js`: Tone.js 封裝，處理移調、音源與效果鏈 (新增和弦字串解析邏輯)。
      - `blocklyManager.js`: Blockly 工作區管理、即時程式碼執行與全域容器約束掃描。
      - `helpUtils.js`: 統一 HelpUrl 生成工具 (語系/路徑)。
      - `midiEngine.js`: MIDI 訊號接收與轉發。
      - `serialEngine.js`: 序列埠通訊。
      - `toolbox.js`: 工具箱 XML 定義 (V2.1 容器化配置)。
    - `ui/`: 介面組件。
      - `adsrVisualizer.js`: ADSR 包絡線視覺化。
      - `visualizer.js`: 即時示波器 (p5.js)。
      - `buttons.js`: 工具列按鈕邏輯。
      - `exampleModal.js`: 範例選單 UI。
      - `logger.js`: 多語系日誌系統。
      - `keyboardController.js`: PC 鍵盤演奏與樂器切換邏輯。
    - `blocks/`: 積木與產生器定義。
      - `instruments_blocks.js`: **(核心) 樂器定義容器、合成器與音源控制、動態來源選擇器**。
      - `instruments_generators.js`: 支援 getContainerTarget() 的產生器。
      - `effects_blocks.js` / `_generators.js`: 效果器積木 (支援容器局部/全域作用)。
      - `sampler_blocks.js`: 取樣器積木 (含 Mutator 與自訂樣本 URL 支援)。
      - `instruments_custom_wave_blocks.js`: 諧波與加法合成自訂波形積木。
      - `transport_blocks.js` / `_generators.js`: 傳輸控制、音序器及循環邏輯 (已清理重複定義)。
      - `serial_blocks.js` / `_generators.js`: 序列埠通訊積木。
      - `lang/`: 自訂語言字串定義 (en.js, zh-hant.js)。
  - `log/`: 開發紀錄。
    - `handover.md`: 任務交接說明。
    - `todo.md`: 任務進度清單。
    - `details.md`: 關鍵技術細節 (踩過的坑)。
    - `work/`: 每日工作日誌 (YYYY-MM-DD.md)。
